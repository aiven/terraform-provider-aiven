// Copyright (c) 2025 Aiven, Helsinki, Finland. https://aiven.io/
// Code generated by user config generator. DO NOT EDIT.

package unit

import (
	"context"
	"fmt"
	"path/filepath"

	"github.com/hashicorp/terraform-plugin-framework/diag"
	"github.com/hashicorp/terraform-plugin-framework/types"

	"github.com/aiven/terraform-provider-aiven/internal/plugin/util"
)

const typeName = "aiven_organizational_unit"

type tfModel struct {
	ID         types.String `tfsdk:"id"`
	CreateTime types.String `tfsdk:"create_time"`
	Name       types.String `tfsdk:"name"`
	ParentID   types.String `tfsdk:"parent_id"`
	TenantID   types.String `tfsdk:"tenant_id"`
	UpdateTime types.String `tfsdk:"update_time"`
}

func (tf *tfModel) SetID(vID string) {
	tf.ID = types.StringValue(filepath.Join(vID))
}

type apiModel struct {
	ID         *string `json:"account_id,omitempty"`
	CreateTime *string `json:"create_time,omitempty"`
	Name       *string `json:"account_name,omitempty"`
	ParentID   *string `json:"parent_account_id,omitempty"`
	TenantID   *string `json:"tenant_id,omitempty"`
	UpdateTime *string `json:"update_time,omitempty"`
}

// idFields the ID attribute fields, i.e.:
// terraform import aiven_organizational_unit.foo ID
func idFields() []string {
	return []string{"id"}
}

// expandData turns TF object into Request
func expandData[R any](ctx context.Context, plan, state *tfModel, req *R, modifiers ...util.MapModifier[tfModel]) diag.Diagnostics {
	api := new(apiModel)
	if !plan.Name.IsNull() || state != nil && !state.Name.IsNull() {
		vName := plan.Name.ValueString()
		api.Name = &vName
	}
	if !plan.ParentID.IsNull() || state != nil && !state.ParentID.IsNull() {
		vParentID := plan.ParentID.ValueString()
		api.ParentID = &vParentID
	}
	err := util.Remarshal(api, req, plan, modifiers...)
	if err != nil {
		var diags diag.Diagnostics
		diags.AddError("Remarshal error", fmt.Sprintf("Failed to remarshal dtoModel to Request: %s", err.Error()))
		return diags
	}
	return nil
}

// flattenData turns Response into TF object
func flattenData[R any](ctx context.Context, state *tfModel, rsp *R, modifiers ...util.MapModifier[tfModel]) diag.Diagnostics {
	api := new(apiModel)
	err := util.Remarshal(rsp, api, state, modifiers...)
	if err != nil {
		var diags diag.Diagnostics
		diags.AddError("Remarshal error", fmt.Sprintf("Failed to remarshal Response to dtoModel: %s", err.Error()))
		return diags
	}
	if api.CreateTime != nil || state.CreateTime.IsUnknown() {
		state.CreateTime = util.StringPointerValue(api.CreateTime)
	}
	if api.ID != nil || state.ID.IsUnknown() {
		state.ID = util.StringPointerValue(api.ID)
	}
	if api.Name != nil && !state.Name.IsUnknown() {
		state.Name = util.StringPointerValue(api.Name)
	}
	if api.ParentID != nil && !state.ParentID.IsUnknown() {
		state.ParentID = util.StringPointerValue(api.ParentID)
	}
	if api.TenantID != nil || state.TenantID.IsUnknown() {
		state.TenantID = util.StringPointerValue(api.TenantID)
	}
	if api.UpdateTime != nil || state.UpdateTime.IsUnknown() {
		state.UpdateTime = util.StringPointerValue(api.UpdateTime)
	}
	return nil
}
